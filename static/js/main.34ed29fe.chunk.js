(this["webpackJsonpreact-typescript-starter-pack"]=this["webpackJsonpreact-typescript-starter-pack"]||[]).push([[0],{32:function(e,t,n){},35:function(e,t,n){"use strict";n.r(t);var o=n(0),r=n(26),a=n.n(r),c=(n(31),n(32),n(5)),i=n(12),s=n(4),u=n.n(s),l=n(6),d=n(9),p=n.n(d),j="https://mate.academy/students-api";function f(e){return new Promise((function(t){setTimeout(t,e)}))}function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o={method:t};n&&(o.body=JSON.stringify(n),o.headers={"Content-Type":"application/json; charset=UTF-8"});var r=function(){var t=Object(l.a)(u.a.mark((function t(){var n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f(300);case 2:return t.next=4,fetch(j+e,o);case 4:if((n=t.sent).ok){t.next=7;break}throw new Error("Something went wrong with the request to the server");case 7:return t.abrupt("return",n.json());case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return r()}var m,h,O=function(e){return b(e)},v=function(e,t){return b(e,"POST",t)},x=function(e,t){return b(e,"PATCH",t)},g=function(e){return b(e,"DELETE")},y=n(2),N=function(e){var t=e.setUser,n=Object(o.useState)(""),r=Object(c.a)(n,2),a=r[0],i=r[1],s=Object(o.useState)(""),d=Object(c.a)(s,2),j=d[0],f=d[1],b=Object(o.useState)(!1),m=Object(c.a)(b,2),h=m[0],x=m[1],g=Object(o.useState)(!1),N=Object(c.a)(g,2),_=N[0],S=N[1],T=Object(o.useState)(!1),k=Object(c.a)(T,2),w=k[0],C=k[1],E=Object(o.useState)(!1),D=Object(c.a)(E,2),A=D[0],I=D[1],U=function(e){var n={id:e.id,email:e.email,name:e.name};t(n),localStorage.setItem("user",JSON.stringify(n))},L=function(){var e=Object(l.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v("/users",{email:a,name:j});case 3:t=e.sent,U(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),S(!0);case 10:return e.prev=10,I(!1),e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[0,7,10,13]])})));return function(){return e.apply(this,arguments)}}();return Object(y.jsx)("div",{className:"todoapp authorization",children:Object(y.jsxs)("div",{className:"todoapp__content authorization__content",children:["Please, login to get yours todos",Object(y.jsxs)("form",{method:"post",onSubmit:function(e){return function(e){if(e.preventDefault(),!(a.length<3))if(I(!0),h){if(j.length<3)return void I(!1);L()}else!function(){var e=Object(l.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O("/users?email=".concat(a));case 3:t=e.sent,(n=t[0])?U(n):(x(!0),C(!0)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),S(!0);case 11:return e.prev=11,I(!1),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[0,8,11,14]])})));return function(){return e.apply(this,arguments)}}()()}(e)},className:"authorization__form",children:[Object(y.jsx)("input",{type:"email",name:"email",placeholder:"Enter your email",value:a,onChange:function(e){i(e.target.value)},className:p()("input is-primary","authorization__input"),disabled:w,minLength:3}),h&&Object(y.jsx)("input",{type:"text",name:"name",placeholder:"Enter your name",value:j,onChange:function(e){return f(e.target.value)},minLength:3,className:p()("input is-primary","authorization__input")}),Object(y.jsx)("button",{type:"submit",className:p()("button","is-primary",{"is-loading":A}),children:"confirm"})]}),_&&Object(y.jsx)("p",{className:"authorization__error",children:"Something went wrong with the authorization."})]})})},_=n(25),S=n(8),T=n(3);!function(e){e.None="None",e.Add="Add",e.Delete="Delete",e.Update="Update",e.Load="Load",e.EmptyInput="EmptyInput"}(m||(m={})),function(e){e.Neutral="Neutral",e.Saving="Saving",e.Deleting="Deleting"}(h||(h={}));var k=function(e){return g("/todos/".concat(e))},w=function(e,t){return x("/todos/".concat(e),t)},C=function(e){var t=e.containsActive,n=e.handleError,r=e.setTodoCondition,a=e.onTrickTempTodo,i=e.setTodos,s=e.toggleAllTodos,d=e.USER_ID,j=Object(o.useState)(""),f=Object(c.a)(j,2),b=f[0],O=f[1],x=Object(o.useState)(!1),g=Object(c.a)(x,2),N=g[0],_=g[1];return Object(y.jsxs)("header",{className:"todoapp__header",children:[Object(y.jsx)("button",{type:"button",className:p()("todoapp__toggle-all",{active:t}),"aria-label":"Complete all todos button",onClick:s}),Object(y.jsx)("form",{onSubmit:function(e){return function(e){if(e.preventDefault(),!b)return n(m.EmptyInput);_(!0),r(h.Saving);var t={id:0,userId:d,title:b,completed:!1};return a(t),O(""),function(){var e=Object(l.a)(u.a.mark((function e(){var o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v("/todos/",t);case 2:o=e.sent;try{a(null),i((function(e){return[].concat(Object(S.a)(e),[o])}))}catch(c){n(m.Add)}finally{r(h.Neutral),_(!1)}case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}(e)},children:Object(y.jsx)("input",{type:"text",className:"todoapp__new-todo",placeholder:"What needs to be done?",value:b,onChange:function(e){var t=e.target;return O(t.value)},disabled:N})})]})},E=function(){},D=function(e){var t=e.todo,n=e.todoCondition,r=e.onDeleteTodo,a=void 0===r?E:r,i=e.toggleTodo,s=void 0===i?E:i,u=e.handleSubmitEditing,l=void 0===u?E:u,d=t.id,j=t.title,f=t.completed,b=Object(o.useState)(!1),m=Object(c.a)(b,2),O=m[0],v=m[1],x=Object(o.useState)(j),g=Object(c.a)(x,2),N=g[0],_=g[1],S=function(e){e.preventDefault(),""===N&&a(d),N!==j&&l(d,N),v(!1)};return Object(y.jsxs)("div",{className:p()("todo",{completed:f}),onDoubleClick:function(){return v(!0)},children:[Object(y.jsx)("label",{className:"todo__status-label",children:Object(y.jsx)("input",{type:"checkbox",className:"todo__status",checked:f,onChange:function(){return s([t])}})}),O?Object(y.jsx)("form",{onSubmit:S,children:Object(y.jsx)("input",{type:"text",className:"todo__title-field",placeholder:"Empty todo will be deleted",value:N,onChange:function(e){_(e.target.value)},onBlur:S,onKeyUp:function(e){"Escape"===e.key&&(v(!1),_(j))}})}):Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)("span",{className:"todo__title",children:j}),Object(y.jsx)("button",{type:"button",className:"todo__remove",onClick:function(){return a(d)},children:"x"})]}),Object(y.jsxs)("div",{className:p()("modal","overlay",{"is-active":n!==h.Neutral}),children:[Object(y.jsx)("div",{className:"modal-background has-background-white-ter"}),Object(y.jsx)("div",{className:"loader"})]})]})},A=function(e){var t=e.todos,n=e.onDeleteTodo,o=e.procesingTodosId,r=e.todoCondition,a=e.toggleTodo,c=e.handleSubmitEditing;return Object(y.jsx)(y.Fragment,{children:t.map((function(e){return Object(y.jsx)(D,{todo:e,onDeleteTodo:n,todoCondition:o.includes(e.id)?r:h.Neutral,toggleTodo:a,handleSubmitEditing:c},e.id)}))})},I=function(e){var t=e.containsCompleted,n=e.onClearCompleted,o=e.itemsLeft;return Object(y.jsxs)("footer",{className:"todoapp__footer",children:[Object(y.jsx)("span",{className:"todo-count",children:"".concat(o," items left")}),Object(y.jsxs)("nav",{className:"filter",children:[Object(y.jsx)(i.b,{to:"/",className:function(e){var t=e.isActive;return p()("filter__link",{selected:t})},children:"All"}),Object(y.jsx)(i.b,{to:"active",className:function(e){var t=e.isActive;return p()("filter__link",{selected:t})},children:"Active"}),Object(y.jsx)(i.b,{to:"completed",className:function(e){var t=e.isActive;return p()("filter__link",{selected:t})},children:"Completed"})]}),Object(y.jsx)("button",{type:"button",className:"todoapp__clear-completed",style:{visibility:t?"visible":"hidden"},onClick:n,children:"Clear completed"})]})},U=function(e){var t=e.errorType,n=e.handleError;return Object(y.jsxs)("div",{className:p()("notification","is-danger","is-light","has-text-weight-normal",{hidden:t===m.None}),children:[Object(y.jsx)("button",{type:"button",className:"delete",onClick:function(){return n(m.None)},"aria-label":"close error"}),t===m.EmptyInput?"Title can't be empty":"Unable to ".concat(t," a todo")]})},L=function(e){var t=e.user,n=Object(o.useState)([]),r=Object(c.a)(n,2),a=r[0],i=r[1],s=Object(o.useState)(m.None),d=Object(c.a)(s,2),p=d[0],j=d[1],f=Object(o.useState)(h.Neutral),b=Object(c.a)(f,2),v=b[0],x=b[1],g=Object(o.useState)([]),N=Object(c.a)(g,2),E=N[0],L=N[1],z=Object(o.useState)(null),F=Object(c.a)(z,2),J=F[0],P=F[1],B=Object(T.j)().pathname,H=Object(T.l)(),R=t.id,q=function(e){e!==m.None&&setTimeout((function(){return j(m.None)}),3e3),j(e)};Object(o.useEffect)((function(){R&&function(){var e=Object(l.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O("/todos?userId=".concat(R));case 2:t=e.sent;try{i(t)}catch(n){q(m.Load)}case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[R]);var G=Object(o.useMemo)((function(){return{isActive:a.some((function(e){return!1===e.completed})),isCompleted:a.some((function(e){return!0===e.completed}))}}),[a]),K=function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k(t);case 2:try{i((function(e){return e.filter((function(e){return e.id!==t}))}))}catch(n){q(m.Delete)}finally{x(h.Neutral)}case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),M=function(e,t){x(h.Saving),e.forEach((function(e){e.completed!==t&&L((function(t){return[].concat(Object(S.a)(t),[e.id])}));var n=Object(S.a)(a),o=n.findIndex((function(t){return t.id===e.id})),r=t||!e.completed;n[o].completed=r,function(){var t=Object(l.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w(e.id,{completed:r});case 2:try{i(n)}catch(o){q(m.Update)}finally{L([]),x(h.Neutral)}case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()()}))},W=a?function(e,t){switch(t){case"/completed":return e.filter((function(e){return!0===e.completed}));case"/active":return e.filter((function(e){return!1===e.completed}));default:return e}}(a,B):[];return Object(y.jsxs)("div",{className:"todoapp",children:[Object(y.jsx)("h1",{className:"todoapp__title",children:"todos"}),Object(y.jsxs)("div",{className:"todoapp__user",children:["Hello ".concat(t.name.toUpperCase()," \ud83d\ude0a"),Object(y.jsx)("button",{type:"button",onClick:function(){localStorage.removeItem("user"),H(0)},className:"button is-outlined is-danger is-small",children:"Logout"})]}),Object(y.jsxs)("div",{className:"todoapp__content",children:[Object(y.jsx)(C,{containsActive:G.isActive,handleError:q,setTodoCondition:x,onTrickTempTodo:P,setTodos:i,toggleAllTodos:function(){M(a,G.isActive)},USER_ID:R}),W&&Object(y.jsx)(y.Fragment,{children:Object(y.jsxs)("section",{className:"todoapp__main",children:[Object(y.jsx)(A,{todos:W,onDeleteTodo:function(e){x(h.Deleting),L([e]),K(e)},todoCondition:v,procesingTodosId:E,toggleTodo:M,handleSubmitEditing:function(e,t){L([e]),x(h.Saving),function(){var n=Object(l.a)(u.a.mark((function n(){return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,w(e,{title:t});case 2:try{i((function(n){return n.map((function(n){return n.id===e?Object(_.a)(Object(_.a)({},n),{},{title:t}):n}))}))}catch(o){j(m.Update)}finally{L([]),x(h.Neutral)}case 3:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}()()}}),J&&Object(y.jsx)(D,{todo:J,todoCondition:v})]})}),!!a.length&&Object(y.jsx)(I,{containsCompleted:G.isCompleted,onClearCompleted:function(){x(h.Deleting),null===a||void 0===a||a.forEach((function(e){e.completed&&(L((function(t){return[].concat(Object(S.a)(t),[e.id])})),K(e.id))}))},itemsLeft:a.filter((function(e){return!e.completed})).length})]}),p!==m.None&&Object(y.jsx)(U,{errorType:p,handleError:j})]})},z=function(){var e=Object(o.useState)(function(){var e=localStorage.getItem("user");return e?JSON.parse(e):null}()),t=Object(c.a)(e,2),n=t[0],r=t[1];return Object(y.jsx)(y.Fragment,{children:n?Object(y.jsx)(i.a,{children:Object(y.jsx)(L,{user:n})}):Object(y.jsx)(N,{setUser:r})})};a.a.render(Object(y.jsx)(z,{}),document.getElementById("root"))}},[[35,1,2]]]);
//# sourceMappingURL=main.34ed29fe.chunk.js.map